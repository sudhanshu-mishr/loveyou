{% extends 'base.html' %}

{% block title %}Chat with {{ other.display_name }} Â· ConnectPU{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8 col-lg-6">
    <div class="chat-card glass-card">
      <div class="card-header d-flex align-items-center bg-white border-0 border-bottom">
        <div class="avatar-sm me-2" style="background-image:url('{{ (other.avatar_filename and url_for('static', filename='uploads/' ~ other.avatar_filename)) or url_for('static', filename='img/avatar_placeholder.svg') }}');"></div>
        <div>
          <div class="fw-semibold">{{ other.display_name }}</div>
          <div class="extra-small text-muted">Matched connection</div>
        </div>
      </div>
      <div class="card-body chat-body">
        {% if messages %}
          {% for message in messages %}
            <div class="chat-bubble-wrapper {% if message.sender_id == current_user.id %}me{% else %}them{% endif %}">
              <div class="chat-bubble">
                <div class="chat-text">{{ message.body }}</div>
                <div class="chat-meta">
                  {{ message.created_at.strftime('%b %d, %H:%M') }}
                </div>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <p class="text-center text-muted small mb-0">Say hi and break the ice ðŸ‘‹</p>
        {% endif %}
      </div>
      <div class="card-footer bg-white border-0 border-top">
        <form method="POST">
          {{ form.hidden_tag() }}
          <div class="input-group">
            {{ form.body(class="form-control", placeholder="Type a message...") }}
            <button class="btn btn-primary" type="submit">{{ form.submit.label.text }}</button>
          </div>
          {% for error in form.body.errors %}
            <div class="form-text text-danger">{{ error }}</div>
          {% endfor %}
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
